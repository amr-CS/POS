

@using System.Data;

@{
    //ViewBag.Title = "الفواتير المرسلة الى الهيئة ";
    ViewBag.Title = ViewBag.ReportName;
    Layout = "~/Views/Shared/appLayout/_LayoutReport.cshtml";
    DataTable Data = ViewBag.vDT;
    if (Data != null)
    {
        DataRow DRow = Data.Rows[0];
    }
    int index = 1;
    double Total = 0;
    double TotalTax = 0;
    double TotalDiscount = 0;
    double TotalSales = 0;
    double TotalVatTotal = 0;
}


<table class="tblitem" dir="rtl" style="margin-right:15px;width:100%">
    <thead style="">
        <tr>
            <th>م</th>
            <th>رقم الفاتورة </th>
            <th>@ViewBag.SecondColumn</th>
            <th>التاريخ </th>
            <th>مبلغ الفاتورة </th>
            <th>الضريبة</th>
            <th>الخصم</th>
            <th width="30%">الصنف </th>
        </tr>
    </thead>
    @if (Data != null)
    {
        foreach (DataRow item in Data.Rows)
        {

            double TotalRow = Convert.ToDouble(item["TotalAfterDiscount"].ToString());
            double TotalTaxRow = Convert.ToDouble(item["TaxAfterDiscount"].ToString());
            double TotalDiscountRow = Convert.ToDouble(item["DiscountBeforeVAT"].ToString());
<tr>
    <td style="text-align: center; vertical-align: middle;">
        @index
    </td>
    <td style="text-align: center; vertical-align: middle;">
        @item["InvCode"]
        <br />
    </td>
    <td style="text-align: center; vertical-align: middle;padding-right:20px">
        @*@item["OrderId"]*@
        @item[ViewBag.SecondColumnDB]
    </td>


    <td style="text-align:center; vertical-align: middle; ">
        @item["InvDate"]

    </td>


    <td style="text-align: center; vertical-align: middle;">
        @item["TotalAfterDiscount"]

    </td>
    <td style="text-align: center; vertical-align: middle;">
        @item["TaxAfterDiscount"]

    </td>
    <td style="text-align: center; vertical-align: middle;">
        @item["DiscountBeforeVAT"]

    </td>
    <td style="text-align: center; vertical-align: middle;">
        @item["ItemName"]

    </td>

</tr>
            index += 1;
            Total = Total + TotalRow;
            TotalTax = TotalTax + TotalTaxRow;
            TotalDiscount = TotalDiscount + TotalDiscountRow;
        }
    }
<tr class="total" style="font-weight: bolder; font-size: larger;">
    <td colspan="4" style="text-align: center; font: bold; vertical-align: middle;">
        الاجمالي الكلي :
        <br />
    </td>
    @*<td style="text-align: center; vertical-align: middle;padding-right:20px">
        </td>

        <td style="text-align: center; vertical-align: middle;">
        </td>*@
    <td style="text-align: center; vertical-align: middle; ">
        @Math.Round(Total, 2, MidpointRounding.ToEven)
    </td>

    <td style="text-align: center; vertical-align: middle;">
        @Math.Round(TotalTax, 2, MidpointRounding.ToEven)
    </td>

    <td style="text-align: center; vertical-align: middle;"> @*font-weight: bolder; font-size: larger; color: black*@
        @Math.Round(TotalDiscount, 2, MidpointRounding.ToEven)
    </td>

    <td style="text-align: center; vertical-align: middle;">
    </td>


</tr>
    <tr>
        <td colspan="10" style="text-align: center; vertical-align: middle; font-weight:bolder;color:darkred;font-size:larger">
            @ViewBag.ExistenceOfData
        </td>
    </tr>
</table>


