@using System.Data;

@{
    ViewBag.Title = "المبيعات تفصيلي";
    Layout = "~/Views/Shared/appLayout/_LayoutReport.cshtml";
    DataTable Data = ViewBag.vDT;
    if (Data != null)
        {
            DataRow DRow = Data.Rows[0];
        }
        double Total = 0;
        double TotalSales = 0;
        double TotalVatTotal = 0;
    }


    <table class="tblitem" dir="rtl" style="margin-right:15px;width:100%">
        <thead style="">
            <tr>
                <th width="30%">اسم الصنف</th>
                <th>الكمية</th>
                <th>الوحدة</th>
                <th>المبلغ </th>
                <th>الضريبة</th>
                <th>الاجمالي </th>
            </tr>
        </thead>
        @if (Data != null)
        {
            foreach (DataRow item in Data.Rows)
            {
                double sales = (Convert.ToDouble(item["Price"]) / (1 + Convert.ToDouble(item["Vat"])));
                double Vat =
                    (Convert.ToDouble(item["Price"]) - (Convert.ToDouble(item["Price"]) / (1 + Convert.ToDouble(item["Vat"]))));
                double TotalRow = Convert.ToDouble(item["Price"].ToString());
                <tr>
                    <td style="text-align: center; vertical-align: middle;">
                        @item["InvItemNameL1"]
                        <br />
                    </td>
                    <td style="text-align: center; vertical-align: middle;padding-right:20px">
                        @item["ItemQty"]
                    </td>
                    <td style="text-align:center; vertical-align: middle; ">
                        @item["LookupDtlDesc"]

                    </td>

                    <td style="text-align:center; vertical-align: middle; ">
                        @Math.Round(sales, 2, MidpointRounding.ToEven)
                    </td>


                    <td style="text-align: center; vertical-align: middle;">
                        @Math.Round(Vat, 2, MidpointRounding.ToEven)
                    </td>
                    <td style="text-align: center; vertical-align: middle;">@item["Price"]</td>


                </tr>
                TotalSales = TotalSales + sales;
                TotalVatTotal = TotalVatTotal + Vat;

                Total = Total + TotalRow;
            }
        }
        <tr class="total">
            <td style="text-align: center;font:bold; vertical-align: middle;">
                اجمالي المبيعات:
                <br />
            </td>
            <td style="text-align: center; vertical-align: middle;padding-right:20px">
            </td>

            <td style="text-align: center; vertical-align: middle;">
            </td>

            <td style="text-align:center;vertical-align: middle;">
                @Math.Round(TotalSales, 2, MidpointRounding.ToEven)

            </td>
            <td style="text-align: center; vertical-align: middle;">
                @Math.Round(TotalVatTotal, 2, MidpointRounding.ToEven)
            </td>

            <td style="text-align: center; vertical-align: middle;">
                @Math.Round(Total, 2, MidpointRounding.ToEven)

            </td>
        </tr>
    </table>
